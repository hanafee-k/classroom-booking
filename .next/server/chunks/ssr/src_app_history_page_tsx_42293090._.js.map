{"version":3,"sources":["../../../../src/app/history/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { supabase } from '@/utils/supabase';\r\nimport './history.css';\r\nimport Navbar from '@/components/common/Navbar';\r\n\r\nexport default function HistoryPage() {\r\n  const [bookings, setBookings] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const fetchHistory = async () => {\r\n    try {\r\n      // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á bookings ‡πÅ‡∏•‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÑ‡∏õ‡∏´‡∏≤‡∏ï‡∏≤‡∏£‡∏≤‡∏á classrooms ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á‡∏°‡∏≤‡∏î‡πâ‡∏ß‡∏¢\r\n      // ‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏ï‡∏£‡∏á select: ‡πÄ‡∏£‡∏≤‡∏™‡∏±‡πà‡∏á classrooms(name) ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏°‡∏µ Foreign Key ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà\r\n      const { data, error } = await supabase\r\n        .from('bookings')\r\n        .select('*, classrooms(name, image_url)')\r\n        .order('id', { ascending: false }); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÑ‡∏õ‡πÄ‡∏Å‡πà‡∏≤‡∏™‡∏∏‡∏î\r\n\r\n      if (error) throw error;\r\n      setBookings(data || []);\r\n    } catch (error: any) {\r\n      console.error('Error fetching history:', error);\r\n      // alert(error.message); // ‡∏õ‡∏¥‡∏î‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏£‡∏≥‡∏Ñ‡∏≤‡∏ç\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchHistory();\r\n  }, []);\r\n\r\n  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡πÜ\r\n  const formatDate = (dateString: string) => {\r\n    if (!dateString) return '-';\r\n    const date = new Date(dateString);\r\n    return date.toLocaleString('th-TH', {\r\n      dateStyle: 'medium',\r\n      timeStyle: 'short',\r\n    });\r\n  };\r\n\r\n  return (\r\n    <main>\r\n      <div className=\"container history-container\">\r\n        <h1>üìú ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h1>\r\n        <p>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö (‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)</p>\r\n\r\n        {loading ? (\r\n          <p>‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>\r\n        ) : (\r\n          <div className=\"table-wrapper\">\r\n            <table className=\"history-table\">\r\n              <thead>\r\n                <tr>\r\n                  <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>\r\n                  <th>‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>\r\n                  <th>‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á</th>\r\n                  <th>‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {bookings.map((item, index) => (\r\n                  <tr key={item.id}>\r\n                    <td>{bookings.length - index}</td>\r\n                    <td>\r\n                      <div className=\"room-cell\">\r\n                        {/* ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• classrooms ‡πÑ‡∏´‡∏° (‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á‡πÇ‡∏î‡∏ô‡∏•‡∏ö) */}\r\n                        {item.classrooms?.image_url && (\r\n                          <img src={item.classrooms.image_url} alt=\"room\" className=\"mini-thumb\" />\r\n                        )}\r\n                        <span>{item.classrooms?.name || '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á'}</span>\r\n                      </div>\r\n                    </td>\r\n                    <td className=\"student-name\">{item.student_name}</td>\r\n                    <td className=\"timestamp\">{formatDate(item.booking_time || item.created_at)}</td>\r\n                  </tr>\r\n                ))}\r\n                \r\n                {bookings.length === 0 && (\r\n                  <tr>\r\n                    <td colSpan={4} style={{textAlign: 'center', padding: '20px'}}>\r\n                      ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡∏ö\r\n                    </td>\r\n                  </tr>\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </main>\r\n  );\r\n}"],"names":[],"mappings":"wDAEA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAIe,SAAS,IACtB,GAAM,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAQ,EAAE,EAC5C,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAEjC,EAAe,UACnB,GAAI,CAGF,GAAM,CAAE,MAAI,OAAE,CAAK,CAAE,CAAG,MAAM,EAAA,QAAQ,CACnC,IAAI,CAAC,YACL,MAAM,CAAC,kCACP,KAAK,CAAC,KAAM,CAAE,WAAW,CAAM,GAElC,CAFsC,EAElC,EAAO,MAAM,EACjB,EAAY,GAAQ,EAAE,CACxB,CAAE,KAJgE,CAIzD,EAAY,CACnB,QAAQ,KAAK,CAAC,0BAA2B,EAE3C,QAAU,CACR,GAAW,EACb,CACF,QAEA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,GACF,EAAG,EAAE,EAaH,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,4BACJ,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,yCAEF,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,yBAEH,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yBACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,0BACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,UACC,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,UACJ,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,cACJ,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,WACJ,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,yBAGR,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,WACE,EAAS,GAAG,CAAC,CAAC,EAAM,iBACnB,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAI,EAAS,MAAM,CAAG,IACvB,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBAEZ,EAAK,UAAU,EAAE,WAChB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,IAAK,EAAK,UAAU,CAAC,SAAS,CAAE,IAAI,OAAO,UAAU,eAE5D,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAM,EAAK,UAAU,EAAE,MAAQ,yBAGpC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,wBAAgB,EAAK,YAAY,GAC/C,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,qBAzC9B,CADkB,AA0CyB,EAAW,CAzClD,CAAC,AAyCsD,YAzC1C,AAyCsD,EAAI,EAAK,UAAU,EAvCnF,AADM,IAAI,KAAK,GACV,cAAc,CAAC,QAAS,CAClC,UAAW,SACX,UAAW,OACb,GALwB,QA6BD,EAAK,EAAE,IAgBG,IAApB,EAAS,MAAM,EACd,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,QAAS,EAAG,MAAO,CAAC,UAAW,SAAU,QAAS,MAAM,WAAG,4CAYnF"}