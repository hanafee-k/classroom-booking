{"version":3,"sources":["../../../../src/app/dashboard/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { supabase } from '@/utils/supabase';\r\nimport './dashboard.css';\r\n\r\ninterface Classroom {\r\n  id: number;\r\n  name: string;\r\n  capacity: number;\r\n  status: string;\r\n  image_url: string;\r\n  booked_by: string | null; // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏°‡∏≤‡∏£‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏à‡∏≠‡∏á\r\n}\r\n\r\nexport default function DashboardPage() {\r\n  const [classrooms, setClassrooms] = useState<Classroom[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const fetchClassrooms = async () => {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('classrooms')\r\n        .select('*')\r\n        .order('id', { ascending: true });\r\n\r\n      if (error) throw error;\r\n      if (data) setClassrooms(data);\r\n    } catch (error) {\r\n      console.error('Error:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchClassrooms();\r\n  }, []);\r\n\r\n  // --- ‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á ---\r\n  const handleBooking = async (room: Classroom) => {\r\n    const userName = window.prompt(`‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á \"${room.name}\"\\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:`);\r\n    if (!userName) return;\r\n\r\n    try {\r\n      // 1. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ (History)\r\n      await supabase.from('bookings').insert([{ room_id: room.id, student_name: userName }]);\r\n\r\n      // 2. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏´‡πâ‡∏≠‡∏á + ‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏à‡∏≠‡∏á (booked_by)\r\n      const { error } = await supabase\r\n        .from('classrooms')\r\n        .update({ \r\n          status: 'busy',\r\n          booked_by: userName // <-- ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏à‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ\r\n        })\r\n        .eq('id', room.id);\r\n\r\n      if (error) throw error;\r\n\r\n      alert('‚úÖ ‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!');\r\n      fetchClassrooms();\r\n\r\n    } catch (error: any) {\r\n      alert(`‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  // --- ‡∏Ñ‡∏∑‡∏ô‡∏´‡πâ‡∏≠‡∏á ---\r\n  const handleCancel = async (room: Classroom) => {\r\n    if (!confirm(`‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô‡∏´‡πâ‡∏≠‡∏á ${room.name} ‡πÉ‡∏ä‡πà‡πÑ‡∏´‡∏°?`)) return;\r\n\r\n    try {\r\n      // ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏á ‡πÅ‡∏•‡∏∞‡∏•‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏à‡∏≠‡∏á‡∏≠‡∏≠‡∏Å (booked_by = null)\r\n      const { error } = await supabase\r\n        .from('classrooms')\r\n        .update({ \r\n          status: 'available',\r\n          booked_by: null \r\n        })\r\n        .eq('id', room.id);\r\n\r\n      if (error) throw error;\r\n\r\n      alert('üëå ‡∏Ñ‡∏∑‡∏ô‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!');\r\n      fetchClassrooms();\r\n\r\n    } catch (error: any) {\r\n      alert(`‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <main>\r\n      <div className=\"container dashboard-container\">\r\n        <header className=\"dashboard-header\">\r\n          <h1>üè´ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h1>\r\n          <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö Real-time</p>\r\n        </header>\r\n\r\n        {loading ? (\r\n          <p className=\"loading-text\">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>\r\n        ) : (\r\n          <div className=\"room-grid\">\r\n            {classrooms.map((room) => (\r\n              <div key={room.id} className=\"room-card\">\r\n                <div className=\"room-image\">\r\n                  <img src={room.image_url || 'https://placehold.co/600x400?text=No+Image'} alt={room.name} />\r\n                  <span className={`status-badge ${room.status}`}>\r\n                    {room.status === 'available' ? '‡∏ß‡πà‡∏≤‡∏á' : '‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á'}\r\n                  </span>\r\n                </div>\r\n                \r\n                <div className=\"room-info\">\r\n                  <h3>{room.name}</h3>\r\n                  <p>üë• ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö: {room.capacity} ‡∏Ñ‡∏ô</p>\r\n                  \r\n                  {/* ‡∏ñ‡πâ‡∏≤‡∏´‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á ‡πÉ‡∏´‡πâ‡πÇ‡∏ä‡∏ß‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏à‡∏≠‡∏á‡∏î‡πâ‡∏ß‡∏¢ */}\r\n                  {room.status === 'busy' && room.booked_by && (\r\n                    <div className=\"booker-info\">\r\n                      üîí ‡∏à‡∏≠‡∏á‡πÇ‡∏î‡∏¢: <strong>{room.booked_by}</strong>\r\n                    </div>\r\n                  )}\r\n\r\n                  {room.status === 'available' ? (\r\n                    <button className=\"btn-book\" onClick={() => handleBooking(room)}>\r\n                      ‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ ‚úÖ\r\n                    </button>\r\n                  ) : (\r\n                    <button className=\"btn-cancel\" onClick={() => handleCancel(room)}>\r\n                      ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á ‚ùå\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </main>\r\n  );\r\n}"],"names":[],"mappings":"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"}